# Pour tester le jeu d'un exercice
# 
# L'exercice doit posséder un bouton pour le mettre en route
# Quand on le met en route, il doit se mettre à jouer, c'est-à-dire qu'il doit
# battre au tempo défini.
# Une date de début de jeu doit avoir été définie
# 
# Quand arrête l'exercice dans un temps raisonnable (enregistrable)
# - Il ne doit plus y avoir de battue
# - Le métronome image doit s'arrêter
# - la date de fin de jeu doit être définie
# - On doit connaitre la durée de jeu de l'exercice
# - Cette durée doit être enregistrée pour le rapport
# - La durée du jeu doit être affichée dans un message
# 
# Quand on arrête l'exercice avant un temps raisonnable (non enregistrable)
# On doit vérifier que toutes les actions ci-dessus ne se font pas
# - On doit vérifier que le message annonce bien que l'exercice n'a pas été pris
#   en compte.
# 
Quand je charge la roadmap "test_benoit-benoit.ackerman@yahoo.fr" comme propriétaire
Et l'image du métronome arrêtée

  # Simple contrôle de la mise en route de l'exercice
  Quand je clique sur le bouton "a#btn_clic-2"
    Alors l'exercice "2" doit être sélectionné
    Et l'exercice "2" doit être en train de jouer
    Et l'image du métronome doit être en mouvement
    Et le métronome de l'exercice "2" doit jouer
    Et le temps de départ de l'exercice "2" doit être défini
    Et le temps de fin de l'exercice "2" doit être null
    Et le bouton "a#btn_clic-2" doit avoir le label "STOP"

  # Jeu d'un exercice avec enregistrement de sa durée de jeu dans le fichier de durées de
  # jeu de la roadmap.
  # @note: le test de l'enregistrement dans le fichier de durées de jeux est assez précis
  # puisqu'il prend en compte le nombre exact de secondes jouées.
  Quand je joue l'exercice "2" pendant 246 secondes
  Et que je clique sur le bouton "a#btn_clic-2"
  Et que j'attends jusqu'à ce que "exercice('2').playing" soit "false"
    Alors l'exercice "2" doit être sélectionné
    Et l'image du métronome doit être arrêtée
    Et le métronome exercice ne doit plus jouer
    Et la durée de jeu de l'exercice "2" doit être définie
    Et le bouton "a#btn_clic-2" doit avoir le label "Play"
    Et le temps de jeu de l'exercice "2" doit être enregistré
    Et le message "MESSAGE.Exercice.work_on_exercice_saved" doit être affiché

  # Test d'un travail de plus d'une heure, quand on décide d'enregistrer la durée de
  # jeu de l'exercice
  Quand je clique sur le bouton "a#btn_clic-1"
  Et que je joue l'exercice "1" pendant 4000 secondes
  Et que je clique sur le bouton "a#btn_clic-1"
    Alors l'alerte "MESSAGE.Exercice.really_save_duree_travail" doit être affichée

    Quand je clique sur le bouton "LOCALE_UI.Exercice.save_duree_travail"
      Alors le temps de jeu de l'exercice "1" doit être enregistré
      Et l'alerte "MESSAGE.Exercice.really_save_duree_travail" ne doit plus être affichée

  # Test d'un travail de plus d'une heure, quand on décide de ne pas enregistrer la durée de
  # jeu de l'exercice
  Quand je clique sur le bouton "a#btn_clic-1"
  Et que je joue l'exercice "1" pendant 4403 secondes
  Et que je clique sur le bouton "a#btn_clic-1"
  Et que l'alerte "MESSAGE.Exercice.really_save_duree_travail" est affichée
  Et que je clique sur le bouton "a#cancel_save_duree_jeu"
    Alors le temps de jeu de l'exercice "1" ne doit pas être enregistré
    Et l'alerte "MESSAGE.Exercice.really_save_duree_travail" ne doit plus être affichée
      